create database if not exists out;
#1、台账——贷款卡片(MILOANCARD)

drop table if exists out.MILOANCARD;
CREATE EXTERNAL
    TABLE out.MILOANCARD
    (
        BUSICODE string,
        BUSITYPE string,
        LOANACCOUNT string,
        BMCFG string,
        CNLNO string,
        DTLNAM string,
        CUSTID string,
        CNAME string,
        TYPEID string,
        CUSTTYPE string,
        CUSTIDTYPE string,
        CUSTIDNO string,
        BRHID string,
        CUSTPROPERTY string,
        UNITCUSTTYPE string,
        INDUSTRY string,
        CITY string,
        DISTRICTCOUNTY string,
        TOWN string,
        COMMUNITY string,
        INSTCODE string,
        DEPTCODE string,
        INSTCITYCODE string,
        TELEPHONE string,
        SYADDR string,
        MESSAGEADDR string,
        RELAMAN string,
        ISREFERAGRICULTURAL string,
        ISRELAMANLOAN string,
        ENTERPRISESTATUS string,
        ECOATTR string,
        CUSTSCALE string,
        CONTROLMODE string,
        CONTRACTNO string,
        CONTRACTMONEY double,
        DELAYTYPE string,
        LOANTYPE string,
        MAINASSURE string,
        ASSUREMANNAME string,
        CREDITLEVEL string,
        REQLMT double,
        ISEXP string,
        PURPOSEREMARK string,
        BUSIMANAGER string,
        ASSISTBUSIMANAGER string,
        FIRSTLOANDATE string,
        REPAYACCOUNT1 string,
        REPAYACCOUNT2 string,
        REPAYACCOUNT3 string,
        LOANDATE string,
        STARTDATE string,
        ORIENDDATE string,
        ENDDATE string,
        LIMIT int,
        LIMITTYPE string,
        RATETYPE string,
        FLOATTYPE string,
        BASERATE double,
        BASERATETYPE string,
        CRTRATE double,
        INTEREST double,
        FLOATRATE double,
        MONEY double,
        CURRENCY string,
        BALAMT double,
        LOANPURPOSE string,
        ACCOUNTSTATE string,
        CLOSEDATE string,
        NOTCOUNTTYPE string,
        OFIVECLASS string,
        FIVECLASS string,
        OTENCLASS string,
        TENCLASS string,
        PASTRATESCALE double,
        REPAYTYPE string,
        REPAYMETHOD string,
        DELAYAMTDAYS int,
        DELAYINTERESTDAYS int,
        FIRSTINTERESTDATE string,
        DEBTINTEREST double,
        DEBTINTERESTTIMES int,
        NORMALACCNO string,
        NORMALAMT double,
        DLAYACCNO string,
        DLAYAMT double,
        DLAYDT string,
        TOVDLYACCNO string,
        TOVDLYAMT double,
        TOVDLYDT string,
        PAYDEBT double,
        INDEBTAMT double,
        OUTDEBTAMT double,
        DEBTINTERESTFLAG string,
        PAYMODE string,
        SQUAREINTERESTMODE string,
        SQUARESTATE string,
        BADTIMEPRIOD int,
        BADLOANDATE string,
        TOBADLOANREASON string,
        AUTOSORTRESULT string,
        LOWRISKFLAG string,
        OPERDATETIME string,
        OPERATOR string,
        MAINBUSINESS string,
        REVOLDTIMES int,
        FIRSTREVOLDDATE string,
        LOANCARDFLAG string,
        ISTRANS string,
        ITEM string,
        FIRSTMANAGER string,
        BATCHFLAG string,
        CONTACTMOBILETEL string,
        ISOUTTABLELOAN string,
        LOANPURPOSEREMARK string,
        IFFNONGCARD string,
        LOANCHANNEL string,
        REPAYCHANNEL string,
        SELFHELPLOANNET string,
        SELFHELPREPAYNET string,
        GUARANTORNAMES string,
        LMTCODE string,
        USEMODE string,
        CONTRACTUSEMODE string,
        CLREQLMT double
    )
    location '/tmp/data/miloancard';
    
    
 2、GC担保信息表(GCASSUREMAIN)
 drop table if exists out.GCASSUREMAIN;
 CREATE EXTERNAL
    TABLE out.GCASSUREMAIN
    (
        KEYCODE string,
        KEYTYPE string,
        EXTENDKEYCODE string,
        GCBUSINESSLEVEL string,
        GCSYSLEVEL string,
        UPKEYCODE string,
        UPKEYTYPE string,
        UPGCBUSINESSLEVEL string,
        UPGCSYSLEVEL string,
        MONEY double,
        CURRENCY string,
        STARTDATE string,
        ENDDATE string,
        LASTDATE string,
        LIMIT int,
        LIMITUNIT string,
        KEYEFFECTEDSTATE string,
        KEYDATESTATE string,
        DEBTORCUSTID string,
        WEALTHCOOWNER string,
        GUARMOD string,
        GUARBALANCE double,
        GUARBASPRICE double,
        GUARBASEPRICECUR string,
        GUARMAXPRICE double,
        GUARMAXPRICECUR string,
        GUARBUSITYPE string,
        OTHERGUARBUSITYPE string,
        ACCESSORYSTATE string,
        INTRSTRATE double,
        INTRSTRATEUNIT string,
        ESPACC string,
        TRNASINSUTERM int,
        COUNTERCLAIMCOND string,
        DISPUTEDSOLVE string,
        ARBITRATEDEPT string,
        CONTNUM int,
        OTHERPROMISE string,
        COMMENTS string,
        EVALUATIONORGCODE string,
        EVALUATEDDATE string,
        EVALUATIONORGNAME string,
        BUSIMANAGER string,
        AVOIDASSUREDUTYCOND string,
        ELSEDUTICOND string,
        ASSUREDUTY string,
        PASSEDDATE string,
        ESTATEHANDOVERTYPE string,
        OTHERPEOPLENAME string,
        EDITIONNO int,
        DEPTCODE string,
        INSTCODE string,
        INSTCITYCODE string,
        OPERATOR string,
        OPERDATETIME string,
        ISTRANS string
    )
    location '/tmp/data/gcassuremain';
    3、GC从合同多方信息表(GCASSUREMULTICLIENT)
    drop table if exists out.GCASSUREMULTICLIENT;
    CREATE EXTERNAL
    TABLE out.GCASSUREMULTICLIENT
    (
        KEYCODE string,
        KEYTYPE string,
        GCBUSINESSLEVEL string,
        GCSYSLEVEL string,
        SEQUENCENO string,
        CLIENTTYPE string,
        CUSTID string,
        CNAME string,
        ISPRIMARYCLIENT string,
        SPOKESMAN string,
        INKDATE string,
        KEYEFFECTEDSTATE string,
        KEYDATESTATE string,
        EDITIONNO int,
        INSTCITYCODE string,
        OPERDATETIME string,
        ISTRANS string
    )
    location '/tmp/data/gcassuremulticlient';
    
    4、机构上下级关系表(XCRMS_GROUPRELATION)
    drop table if exists out.XCRMS_GROUPRELATION;
    CREATE EXTERNAL
    TABLE out.XCRMS_GROUPRELATION
    (
        UPGROUPID string,
        LOWGROUPID string,
        UPGROUPCODE string,
        LOWGROUPCODE string,
        UPGROUPTYPE string,
        LOWGROUPTYPE string
    )
    location '/tmp/data/XCRMS_GROUPRELATION';
    
    4、参数关系(PMPARAMRELATION)
    drop table if exists out.PMPARAMRELATION;
    CREATE EXTERNAL
    TABLE out.PMPARAMRELATION
    (
        PARAMCLASSID string,
        UPPARAMID string,
        LOWPARAMID string,
        UPPARAMCODE string,
        LOWPARAMCODE string,
        PARAMTYPE string
    )
    location '/tmp/data/pmparamrelation';
    
    5、参数字典基本信息表(PARAM_CLASS)
    drop table if exists out.PARAM_CLASS;
    CREATE EXTERNAL
    TABLE out.PARAM_CLASS
    (
        ID string,
        NAME string,
        DISPLAY string,
        TYPE string,
        SCOPE string,
        TREE string,
        CODEGENERATOR string,
        CODELENGTH int,
        CODEAUTOGENERATE string,
        DESCRIPTION string,
        NAMECAPTION string,
        CODECAPTION string,
        BRIEFNAMECAPTION string,
        CLASSURI string,
        REPOSITORYPROCESSOR string,
        DISPLAYURI string
    )
    location '/tmp/data/param_class';
  drop table if exists out.OM_EMPLOYEE;
  CREATE EXTERNAL
    TABLE out.OM_EMPLOYEE
    (
        EMPID double,
        EMPCODE string,
        OPERATORID double,
        USERID string,
        EMPNAME string,
        REALNAME string,
        GENDER string,
        BIRTHstring string,
        POSITION double,
        EMPSTATUS string,
        CARDTYPE string,
        CARDNO string,
        INstring string,
        OUTstring string,
        OTEL string,
        OADDRESS string,
        OZIPCODE string,
        OEMAIL string,
        FAXNO string,
        MOBILENO string,
        MSN string,
        HTEL string,
        HADDRESS string,
        HZIPCODE string,
        PEMAIL string,
        PARTY string,
        DEGREE string,
        MAJOR string,
        SPECIALTY string,
        WORKEXP string,
        REGstring string,
        CREATETIME string,
        LASTMODYTIME string,
        ORGIDLIST string,
        ORGID double,
        REMARK string,
        SORTNO int,
        UNIONID string
    )
    location '/tmp/data/employee';
  
  CREATE EXTERNAL
    TABLE out.OM_ORGANIZATION
    (
        ORGID double,
        ORGCODE string,
        ORGNAME string,
        ORGLEVEL double ,
        ORGDEGREE string,
        PARENTORGID double,
        ORGSEQ string,
        ORGTYPE string,
        ORGADDR string,
        ZIPCODE string,
        MANAPOSITION double,
        MANAGERID double,
        ORGMANAGER string,
        LINKMAN string,
        LINKTEL string,
        EMAIL string,
        WEBURL string,
        STARTstring string,
        ENDstring string,
        STATUS string,
        AREA string,
        CREATETIME string,
        LASTUPstring string,
        UPDATOR double,
        SORTNO int,
        ISLEAF string,
        SUBCOUNT double,
        REMARK string,
        GROUPID string,
        PARENTID string
    )location '/tmp/data/organization';
impala中刷metadata
 invalidate metadata